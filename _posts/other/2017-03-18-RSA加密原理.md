---
layout: article
title: "RSA加密原理"
categories: other
excerpt: "RSA算法是目前地球上最重要的加密算法，了解它的加密原理才能更好的理解RSA的加密过程"
ads: true
share: false
image:
---

## 背景

1977年，三位数学家Rivest、Shamir 和 Adleman 设计了一种算法，可以实现非对称加密。这种算法用他们三个人的名字命名，叫做RSA算法。要理解RSA加密的原理，需要先了解另一篇文章[欧拉定理](http://www.overflowstack.com/other/%E6%AC%A7%E6%8B%89%E5%AE%9A%E7%90%86/).

## 密钥的生成步骤

加入A想把信息m通过RSA加密后传给B，生成密钥的过程大概是这样的

### 第一步 随机选择两个不相等的质数p和q

A选择了61 和 53，这两个质数越大就越难破解

### 第二步 计算p和q的乘积n

`n = p*q = 61*53 = 3233`

n的长度就是密钥长度。3233写成二进制是110010100001，一共有12位，所以这个密钥就是12位。实际应用中，RSA密钥一般是1024位，重要场合则为2048位。

### 第三步 计算n的欧拉函数φ(n)

`φ(n) = φ(p)φ(q) = (p - 1)*(q - 1) = 60*32 = 3120`

### 第四步 随机选择一个整数e，条件是1< e < φ(n)，且e与φ(n) 互质

A就在1到3120之间，随机选择了17。（实际应用中，常常选择65537）

### 第五步 计算e对于φ(n)的模反元素d

`ed ≡ 1 (mod φ(n))`

这个式子等价于 `ed = kφ(n) + 1`,那么

模反元素`17d = k*3120 + 1`

经过计算得出一组结果，k = 15，d = 2753

### 第六步 将n和e封装成公钥，n和d封装成私钥

n = 3233,e = 17,d = 2753 所以公钥就是 (3233,17)，私钥就是（3233, 2753）

## 加密解密

### 用公钥 (n,e)加密

B向A发送信息m，他就要用A的公钥 (n,e) 对m进行加密，c为加密后的数据

`m^e ≡ c(mod n)`

假如m = 65, `65^17 ≡ 2790 (mod 3233)`, 所以加密后的c为2790，B将2790发给A

### 用私钥 (n,d)解密

A拿到B用公钥加密后的数据2790，要用自己的私钥（3233, 2753）解密。

`c^d ≡ m (mod n)`

也就是说，c的d次方除以n的余数为m。现在，c等于2790，私钥是(3233, 2753)，那么A算出，

`2790^2753 ≡ 65(mod 3233)`

因此，A就知道了B发送的数据m为65

公钥(n,e) 只能加密小于n的整数m，那么如果要加密大于n的整数，该怎么办？有两种解决方法：一种是把长信息分割成若干段短消息，每段分别加密；另一种是先选择一种”对称性加密算法”（比如DES），用这种算法的密钥加密信息，再用RSA公钥加密DES密钥。

## 私钥解密的证明

为什么用私钥解密，一定可以正确地得到m

`c^d ≡ m(mod n)`

`m^e ≡ c(mod n)`

