---
layout: article
title: "把像素显示到屏幕上(译)"
categories: iOS
excerpt: "如何把一个像素显示到屏幕上？有很多种方法，这些方法包含不同的framework和很多不同的函数和方法的组合。在这里，我们将讲述一些发生在幕后的事情。"
ads: true
share: false
image:
---

**By [Daniel Eggert](https://twitter.com/danielboedewadt)** 

[原文网址](https://www.objc.io/issues/3-views/moving-pixels-onto-the-screen/)

如何把一个像素显示到屏幕上？有很多种方法，这些方法包含不同的framework和很多不同的函数和方法的组合。在这里，我们将讲述一些发生在幕后的事情。我们希望这篇文章能帮你理解当你需要决定调试和修复性能问题的时候哪个API最好。这篇文章虽然是以iOS为例，但是大多数讲的内容也同时适用于OS X。

## 图形堆栈

当像素要显示到屏幕上时，许多事情在幕后悄悄进行着。但是一旦这些像素已经在屏幕上了，每个像素由三个元素组成：红、黄、蓝。三种单独的颜色单元以不同的强度叠加显示，组成一个特定颜色的像素。你的iPhone5，液晶显示屏有1,136*640 = 727,040个像素，也就是2,181,120个颜色单元。一个15英寸的retina屏幕的话，这个数字将会超过15500000。整儿图形堆栈一起动作来确保每个颜色单元显示正确的强度。当你滚动屏幕时，所有的这些鼠疫百万计的像素每秒要更新60次，这是一个巨大的工作量。

### 软件组件

简单的看，软件上的栈看起来就像这样：

![](https://www.objc.io/images/issue-3/pixels-software-stack@2x-1ae69f5a.png)

Display的上面是GPU（graphics processing unit）。GPU是一个专门为并行图形计算设计的高并发的处理单元。这样才能更新大量的像素点，并把他们显示在屏幕上。它的并行特性也使得它可以很有效地合成纹理。我们一会儿会更详细的讨论合成纹理。关键是GPU是专门设计的，因此在处理一些类似工作时更加高效，例如它处理图像时比cpu更快，消耗的能量更少。CPU有着广泛的用途，可以做很多不同的事情，但是例如合成纹理的话，还是GPU更快。

GPU驱动是一段可以直接和GPU对话的代码。它让不同类型的GPU对下一层OpenGL/OpenGL ES表现的更加统一。

OpenGL(Open Graphics Libiary) 是一个渲染2D或者3D图像的API。GPU是一个非常专业化的硬件，OpenGL和GPU非常紧密的合作来发挥GPU的计算特性和实现硬件加速渲染。对于很多人来说，OpenGL或许看起来非常底层，但是它在1992年发布时，就是第一个和GPU对话的主要的标准方法，这是一个巨大的进步，因为程序员再也不用为了各个GPU重写他们的应用。

在OpenGL上一层，有点儿分叉。在iOS系统上，几乎所有的事情都是通过Core Animation，在OS X上，Core Graphics 绕过Core Animation的情况非常常见。对于一些专门化的应用来说，尤其是游戏，app 可以直接和OpenGL/OpenGL ES对话。有点儿让人有点儿迷惑的是Core Animation 的部分渲染使用了 Core Graphics，像AVFoundation、Core Image和其他框架这样的框架可以将所有东西混合起来。

要记住一件事情，GPU是一个非常强大的进行图像处理的硬件，在显示像素上处于中心地位。它和CPU连接。在硬件层面，总线连接GPU和CPU，像OpenGL, Core Animation和 Core Graphics这些框架协调GPU和CPU之间的数据传输。为了让像素点显示在屏幕上，有些处理需要在CPU上进行，然后处理过的数据传输给GPU，GPU再做处理，最终像素点显示在屏幕上。

这个过程的每个部分都有自己的挑战的部分，在这个过程中也会有一些权衡。